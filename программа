import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

file="./Solar_Taj.xlsx"
solarData=pd.read_excel(io=file,
engine='openpyxl');

keys=[]
for value in solarData:
keys.append(value)

months=[]
for value in solarData[keys[0]]:
months.append(f"{value}".split('-')[1])

times=[]
for value in solarData[keys[1]]:
times.append(value.hour)

etrs=[]
for value in solarData[keys[3]]:
etrs.append(value)

maxValues=[]
averageValues=[]

tempMaxValue=0
tempAverage=0

index=0
for time in times:
if int(months[index]) != 1:
break

if etrs[index] > tempMaxValue:
tempMaxValue=etrs[index]

tempAverage+=etrs[index]
if 0 == time:
averageValues.append(tempAverage/24)
maxValues.append(tempMaxValue)
tempAverage=0
tempMaxValue=0
index+=1

days=[]
for i in range(31):
days.append(i+1)

plt.figure(figsize=(10, 5))
plt.plot(maxValues,days, label="max values per day")
plt.plot(averageValues,days,label="average values per day")
plt.grid(True)
plt.legend(loc='best', fontsize=12)
plt.show()
